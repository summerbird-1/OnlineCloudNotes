{"remainingRequest":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue?vue&type=style&index=0&id=28a71889&lang=less&scoped=true","dependencies":[{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue","mtime":1703320567699},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\css-loader@3.6.0\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\postcss-loader@3.0.0\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\less-loader@5.0.0\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouc3VibWl0LW5vdGUtY29udGVudCB7DQogIGZsZXg6IDE7DQogIGJhY2tncm91bmQ6ICNmZmY7DQogIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgYm9yZGVyOiAxcHggc29saWQgI2RjZGNkYzsNCiAgYm9yZGVyLWJvdHRvbTogbm9uZTsNCiAgcGFkZGluZzogMTBweDsNCg0KICAucmVxdWlyZSB7DQogICAgJjo6YmVmb3JlIHsNCiAgICAgIGNvbnRlbnQ6ICcqJzsNCiAgICAgIGNvbG9yOiAjZjU2YzZjOw0KICAgICAgbWFyZ2luLXJpZ2h0OiA0cHg7DQogICAgfQ0KICB9DQoNCiAgLnRpdGxlIHsNCiAgICAmID4gc3BhbiB7DQogICAgICBtYXJnaW4tcmlnaHQ6IDIwcHg7DQogICAgfQ0KICAgIG1hcmdpbi1ib3R0b206IDE1cHg7DQogIH0NCg0KICAudGFnIHsNCiAgICAmID4gc3BhbiB7DQogICAgICBtYXJnaW4tcmlnaHQ6IDI0cHg7DQogICAgfQ0KICAgIG1hcmdpbi1ib3R0b206IDE1cHg7DQogIH0NCg0KICAuY29udGVudCB7DQogICAgLmNvbnRlbnQtdGl0bGUgew0KICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDsNCiAgICB9DQogICAgbWFyZ2luLWJvdHRvbTogMTVweDsNCiAgfQ0KICAudXBsb2FkIHsNCiAgICAmID4gc3BhbiB7DQogICAgICBtYXJnaW4tcmlnaHQ6IDI0cHg7DQogICAgICBtYXJnaW4tdG9wOiA1cHg7DQogICAgfQ0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7DQogICAgbWFyZ2luLXRvcDogNXB4Ow0KICAgIGhlaWdodDogODBweDsNCiAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogIH0NCg0KICAuc3VibWl0IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogIH0NCn0NCg=="},{"version":3,"sources":["SubmitNoteContent.vue"],"names":[],"mappings":";AAqKA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"SubmitNoteContent.vue","sourceRoot":"src/views/submitNote/childrens","sourcesContent":["<template>\r\n  <div class=\"submit-note-content\">\r\n    <div class=\"title\">\r\n      <span class=\"require\">Note Title </span>\r\n      <el-input\r\n        style=\"width: 350px\"\r\n        type=\"text\"\r\n        placeholder=\"please input note title\"\r\n        v-model=\"title\"\r\n        maxlength=\"20\"\r\n        show-word-limit\r\n      >\r\n      </el-input>\r\n    </div>\r\n\r\n    <div class=\"tag\">\r\n      <span class=\"require\">Note Tag </span>\r\n\r\n      <el-select\r\n        v-model=\"tagValues\"\r\n        multiple\r\n        placeholder=\"please select tag\"\r\n        style=\"width: 350px\"\r\n      >\r\n        <el-option v-for=\"item in tagOptions\" :key=\"item\" :value=\"item\">\r\n        </el-option>\r\n      </el-select>\r\n    </div>\r\n    <div class=\"content\">\r\n      <div class=\"content-title require\">Note Content</div>\r\n      <Editor v-model=\"noteContent\" ref=\"editor\" />\r\n    </div>\r\n\r\n    <div class=\"upload\">\r\n      <span class=\"require\">Note Image</span>\r\n      <el-upload\r\n        ref=\"upload\"\r\n        :action=\"uploadUrl\"\r\n        :file-list=\"fileList\"\r\n        :auto-upload=\"false\"\r\n        :before-upload=\"checkFile\"\r\n        accept=\".jpg,.png,.jpeg\"\r\n        :http-request=\"submitNoteData\"\r\n        :limit=\"1\"\r\n      >\r\n        <el-button size=\"small\" type=\"primary\">post note image</el-button>\r\n        <div slot=\"tip\" class=\"el-upload__tip\">\r\n          Only a single image in jpg/png/jpeg format can be uploaded and the\r\n          maximum size is 10MB\r\n        </div>\r\n      </el-upload>\r\n    </div>\r\n\r\n    <div class=\"submit\">\r\n      <el-button type=\"primary\" @click=\"handleSubmitNote\"\r\n        >submit note</el-button\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Editor from './Editor.vue'\r\nimport { saveNoteData } from '@/network/note/index.js'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      title: '',\r\n      tagValues: [],\r\n      noteContent: '',\r\n      tagOptions: ['HTML', 'MySQL', 'PHP', 'Java', 'Python'],\r\n      uploadUrl: '',\r\n      fileList: [],\r\n      fileNameMatch: ['jpeg', 'jpg', 'png']\r\n    }\r\n  },\r\n  components: { Editor },\r\n  methods: {\r\n    /**\r\n     * 实际提交数据方法\r\n     */\r\n    async submitNoteData(param) {\r\n      if (this.$refs.editor.isNeedUpload()) {\r\n        // 如果笔记内有图片，那么先进行图片上传\r\n        await this.$refs.editor.uploadimg()\r\n      }\r\n\r\n      // 对多个tag进行转换数据格式\r\n      const tags = this.tagValues.join(',')\r\n\r\n      const formData = new FormData()\r\n\r\n      // 如果地址栏上有groupId，证明是分组内提交的\r\n      const id = this.$route?.query.groupId\r\n      if (id) formData.append('groupId', id)\r\n\r\n      formData.append('noteImg', param.file)\r\n      formData.append('title', this.title)\r\n      formData.append('content', this.noteContent)\r\n      formData.append('tag', tags)\r\n      formData.append('userId', this.$store.state.userInfo.userid)\r\n\r\n      saveNoteData(formData).then(() => {\r\n        this.$message.success('笔记发布成功')\r\n        id\r\n          ? this.$router.push(`/group?id=${id}&page=1`)\r\n          : this.$router.push('/')\r\n      })\r\n    },\r\n    validateNoteInfo() {\r\n      if (\r\n        this.title == '' ||\r\n        this.tagValues.length === 0 ||\r\n        this.noteContent == '' ||\r\n        this.$refs.upload.uploadFiles.length == 0\r\n      ) {\r\n        this.$message.warning('信息未填完整，请检查')\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    handleSubmitNote() {\r\n      if (this.validateNoteInfo()) {\r\n        // 调用upload组件的上传方法，在它内部做提交\r\n        this.$refs.upload.submit()\r\n      }\r\n    },\r\n    checkFile(file) {\r\n      //上传之前的操作，file上传的文件对象\r\n      let name = file.name\r\n      if (name.lastIndexOf('.') == -1) {\r\n        this.$message.warning('文件格式不正确')\r\n        return false\r\n      } else {\r\n        //获取后缀\r\n        let suff = name.substring(name.lastIndexOf('.') + 1)\r\n        var count = 0\r\n        //遍历提前定义好的后缀数组\r\n        for (var i in this.fileNameMatch) {\r\n          //如果有匹配的(注意大小写问题)\r\n          if (this.fileNameMatch[i].toLowerCase() == suff.toLowerCase()) {\r\n            count++\r\n            //匹配到就退出循环\r\n            break\r\n          }\r\n        }\r\n        //如果没匹配到\r\n        if (count == 0) {\r\n          this.$message.warning('只能上传jpg,png,jpeg格式的图片')\r\n          return false\r\n        }\r\n      }\r\n\r\n      //判断文件大小\r\n      if (file.size > 1024 * 1024 * 10) {\r\n        this.$message.warning('文件大小不能超过10MB')\r\n        return false\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.submit-note-content {\r\n  flex: 1;\r\n  background: #fff;\r\n  border-radius: 5px;\r\n  border: 1px solid #dcdcdc;\r\n  border-bottom: none;\r\n  padding: 10px;\r\n\r\n  .require {\r\n    &::before {\r\n      content: '*';\r\n      color: #f56c6c;\r\n      margin-right: 4px;\r\n    }\r\n  }\r\n\r\n  .title {\r\n    & > span {\r\n      margin-right: 20px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n\r\n  .tag {\r\n    & > span {\r\n      margin-right: 24px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n\r\n  .content {\r\n    .content-title {\r\n      margin-bottom: 10px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n  .upload {\r\n    & > span {\r\n      margin-right: 24px;\r\n      margin-top: 5px;\r\n    }\r\n    display: flex;\r\n    align-items: flex-start;\r\n    margin-top: 5px;\r\n    height: 80px;\r\n    margin-bottom: 5px;\r\n  }\r\n\r\n  .submit {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n}\r\n</style>\r\n"]}]}