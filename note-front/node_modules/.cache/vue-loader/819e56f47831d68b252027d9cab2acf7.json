{"remainingRequest":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue","mtime":1703320567699},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\babel-loader@8.3.0\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgRWRpdG9yIGZyb20gJy4vRWRpdG9yLnZ1ZScNCmltcG9ydCB7IHNhdmVOb3RlRGF0YSB9IGZyb20gJ0AvbmV0d29yay9ub3RlL2luZGV4LmpzJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHRpdGxlOiAnJywNCiAgICAgIHRhZ1ZhbHVlczogW10sDQogICAgICBub3RlQ29udGVudDogJycsDQogICAgICB0YWdPcHRpb25zOiBbJ0hUTUwnLCAnTXlTUUwnLCAnUEhQJywgJ0phdmEnLCAnUHl0aG9uJ10sDQogICAgICB1cGxvYWRVcmw6ICcnLA0KICAgICAgZmlsZUxpc3Q6IFtdLA0KICAgICAgZmlsZU5hbWVNYXRjaDogWydqcGVnJywgJ2pwZycsICdwbmcnXQ0KICAgIH0NCiAgfSwNCiAgY29tcG9uZW50czogeyBFZGl0b3IgfSwNCiAgbWV0aG9kczogew0KICAgIC8qKg0KICAgICAqIOWunumZheaPkOS6pOaVsOaNruaWueazlQ0KICAgICAqLw0KICAgIGFzeW5jIHN1Ym1pdE5vdGVEYXRhKHBhcmFtKSB7DQogICAgICBpZiAodGhpcy4kcmVmcy5lZGl0b3IuaXNOZWVkVXBsb2FkKCkpIHsNCiAgICAgICAgLy8g5aaC5p6c56yU6K6w5YaF5pyJ5Zu+54mH77yM6YKj5LmI5YWI6L+b6KGM5Zu+54mH5LiK5LygDQogICAgICAgIGF3YWl0IHRoaXMuJHJlZnMuZWRpdG9yLnVwbG9hZGltZygpDQogICAgICB9DQoNCiAgICAgIC8vIOWvueWkmuS4qnRhZ+i/m+ihjOi9rOaNouaVsOaNruagvOW8jw0KICAgICAgY29uc3QgdGFncyA9IHRoaXMudGFnVmFsdWVzLmpvaW4oJywnKQ0KDQogICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpDQoNCiAgICAgIC8vIOWmguaenOWcsOWdgOagj+S4iuaciWdyb3VwSWTvvIzor4HmmI7mmK/liIbnu4TlhoXmj5DkuqTnmoQNCiAgICAgIGNvbnN0IGlkID0gdGhpcy4kcm91dGU/LnF1ZXJ5Lmdyb3VwSWQNCiAgICAgIGlmIChpZCkgZm9ybURhdGEuYXBwZW5kKCdncm91cElkJywgaWQpDQoNCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbm90ZUltZycsIHBhcmFtLmZpbGUpDQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RpdGxlJywgdGhpcy50aXRsZSkNCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnY29udGVudCcsIHRoaXMubm90ZUNvbnRlbnQpDQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RhZycsIHRhZ3MpDQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3VzZXJJZCcsIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnVzZXJpZCkNCg0KICAgICAgc2F2ZU5vdGVEYXRhKGZvcm1EYXRhKS50aGVuKCgpID0+IHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfnrJTorrDlj5HluIPmiJDlip8nKQ0KICAgICAgICBpZA0KICAgICAgICAgID8gdGhpcy4kcm91dGVyLnB1c2goYC9ncm91cD9pZD0ke2lkfSZwYWdlPTFgKQ0KICAgICAgICAgIDogdGhpcy4kcm91dGVyLnB1c2goJy8nKQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHZhbGlkYXRlTm90ZUluZm8oKSB7DQogICAgICBpZiAoDQogICAgICAgIHRoaXMudGl0bGUgPT0gJycgfHwNCiAgICAgICAgdGhpcy50YWdWYWx1ZXMubGVuZ3RoID09PSAwIHx8DQogICAgICAgIHRoaXMubm90ZUNvbnRlbnQgPT0gJycgfHwNCiAgICAgICAgdGhpcy4kcmVmcy51cGxvYWQudXBsb2FkRmlsZXMubGVuZ3RoID09IDANCiAgICAgICkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+S/oeaBr+acquWhq+WujOaVtO+8jOivt+ajgOafpScpDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIHRydWUNCiAgICB9LA0KICAgIGhhbmRsZVN1Ym1pdE5vdGUoKSB7DQogICAgICBpZiAodGhpcy52YWxpZGF0ZU5vdGVJbmZvKCkpIHsNCiAgICAgICAgLy8g6LCD55SodXBsb2Fk57uE5Lu255qE5LiK5Lyg5pa55rOV77yM5Zyo5a6D5YaF6YOo5YGa5o+Q5LqkDQogICAgICAgIHRoaXMuJHJlZnMudXBsb2FkLnN1Ym1pdCgpDQogICAgICB9DQogICAgfSwNCiAgICBjaGVja0ZpbGUoZmlsZSkgew0KICAgICAgLy/kuIrkvKDkuYvliY3nmoTmk43kvZzvvIxmaWxl5LiK5Lyg55qE5paH5Lu25a+56LGhDQogICAgICBsZXQgbmFtZSA9IGZpbGUubmFtZQ0KICAgICAgaWYgKG5hbWUubGFzdEluZGV4T2YoJy4nKSA9PSAtMSkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+aWh+S7tuagvOW8j+S4jeato+ehricpDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgLy/ojrflj5blkI7nvIANCiAgICAgICAgbGV0IHN1ZmYgPSBuYW1lLnN1YnN0cmluZyhuYW1lLmxhc3RJbmRleE9mKCcuJykgKyAxKQ0KICAgICAgICB2YXIgY291bnQgPSAwDQogICAgICAgIC8v6YGN5Y6G5o+Q5YmN5a6a5LmJ5aW955qE5ZCO57yA5pWw57uEDQogICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5maWxlTmFtZU1hdGNoKSB7DQogICAgICAgICAgLy/lpoLmnpzmnInljLnphY3nmoQo5rOo5oSP5aSn5bCP5YaZ6Zeu6aKYKQ0KICAgICAgICAgIGlmICh0aGlzLmZpbGVOYW1lTWF0Y2hbaV0udG9Mb3dlckNhc2UoKSA9PSBzdWZmLnRvTG93ZXJDYXNlKCkpIHsNCiAgICAgICAgICAgIGNvdW50KysNCiAgICAgICAgICAgIC8v5Yy56YWN5Yiw5bCx6YCA5Ye65b6q546vDQogICAgICAgICAgICBicmVhaw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvL+WmguaenOayoeWMuemFjeWIsA0KICAgICAgICBpZiAoY291bnQgPT0gMCkgew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn5Y+q6IO95LiK5LyganBnLHBuZyxqcGVn5qC85byP55qE5Zu+54mHJykNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICAvL+WIpOaWreaWh+S7tuWkp+Wwjw0KICAgICAgaWYgKGZpbGUuc2l6ZSA+IDEwMjQgKiAxMDI0ICogMTApIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfmlofku7blpKflsI/kuI3og73otoXov4cxME1CJykNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICB9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["SubmitNoteContent.vue"],"names":[],"mappings":";AA8DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SubmitNoteContent.vue","sourceRoot":"src/views/submitNote/childrens","sourcesContent":["<template>\r\n  <div class=\"submit-note-content\">\r\n    <div class=\"title\">\r\n      <span class=\"require\">Note Title </span>\r\n      <el-input\r\n        style=\"width: 350px\"\r\n        type=\"text\"\r\n        placeholder=\"please input note title\"\r\n        v-model=\"title\"\r\n        maxlength=\"20\"\r\n        show-word-limit\r\n      >\r\n      </el-input>\r\n    </div>\r\n\r\n    <div class=\"tag\">\r\n      <span class=\"require\">Note Tag </span>\r\n\r\n      <el-select\r\n        v-model=\"tagValues\"\r\n        multiple\r\n        placeholder=\"please select tag\"\r\n        style=\"width: 350px\"\r\n      >\r\n        <el-option v-for=\"item in tagOptions\" :key=\"item\" :value=\"item\">\r\n        </el-option>\r\n      </el-select>\r\n    </div>\r\n    <div class=\"content\">\r\n      <div class=\"content-title require\">Note Content</div>\r\n      <Editor v-model=\"noteContent\" ref=\"editor\" />\r\n    </div>\r\n\r\n    <div class=\"upload\">\r\n      <span class=\"require\">Note Image</span>\r\n      <el-upload\r\n        ref=\"upload\"\r\n        :action=\"uploadUrl\"\r\n        :file-list=\"fileList\"\r\n        :auto-upload=\"false\"\r\n        :before-upload=\"checkFile\"\r\n        accept=\".jpg,.png,.jpeg\"\r\n        :http-request=\"submitNoteData\"\r\n        :limit=\"1\"\r\n      >\r\n        <el-button size=\"small\" type=\"primary\">post note image</el-button>\r\n        <div slot=\"tip\" class=\"el-upload__tip\">\r\n          Only a single image in jpg/png/jpeg format can be uploaded and the\r\n          maximum size is 10MB\r\n        </div>\r\n      </el-upload>\r\n    </div>\r\n\r\n    <div class=\"submit\">\r\n      <el-button type=\"primary\" @click=\"handleSubmitNote\"\r\n        >submit note</el-button\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Editor from './Editor.vue'\r\nimport { saveNoteData } from '@/network/note/index.js'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      title: '',\r\n      tagValues: [],\r\n      noteContent: '',\r\n      tagOptions: ['HTML', 'MySQL', 'PHP', 'Java', 'Python'],\r\n      uploadUrl: '',\r\n      fileList: [],\r\n      fileNameMatch: ['jpeg', 'jpg', 'png']\r\n    }\r\n  },\r\n  components: { Editor },\r\n  methods: {\r\n    /**\r\n     * 实际提交数据方法\r\n     */\r\n    async submitNoteData(param) {\r\n      if (this.$refs.editor.isNeedUpload()) {\r\n        // 如果笔记内有图片，那么先进行图片上传\r\n        await this.$refs.editor.uploadimg()\r\n      }\r\n\r\n      // 对多个tag进行转换数据格式\r\n      const tags = this.tagValues.join(',')\r\n\r\n      const formData = new FormData()\r\n\r\n      // 如果地址栏上有groupId，证明是分组内提交的\r\n      const id = this.$route?.query.groupId\r\n      if (id) formData.append('groupId', id)\r\n\r\n      formData.append('noteImg', param.file)\r\n      formData.append('title', this.title)\r\n      formData.append('content', this.noteContent)\r\n      formData.append('tag', tags)\r\n      formData.append('userId', this.$store.state.userInfo.userid)\r\n\r\n      saveNoteData(formData).then(() => {\r\n        this.$message.success('笔记发布成功')\r\n        id\r\n          ? this.$router.push(`/group?id=${id}&page=1`)\r\n          : this.$router.push('/')\r\n      })\r\n    },\r\n    validateNoteInfo() {\r\n      if (\r\n        this.title == '' ||\r\n        this.tagValues.length === 0 ||\r\n        this.noteContent == '' ||\r\n        this.$refs.upload.uploadFiles.length == 0\r\n      ) {\r\n        this.$message.warning('信息未填完整，请检查')\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    handleSubmitNote() {\r\n      if (this.validateNoteInfo()) {\r\n        // 调用upload组件的上传方法，在它内部做提交\r\n        this.$refs.upload.submit()\r\n      }\r\n    },\r\n    checkFile(file) {\r\n      //上传之前的操作，file上传的文件对象\r\n      let name = file.name\r\n      if (name.lastIndexOf('.') == -1) {\r\n        this.$message.warning('文件格式不正确')\r\n        return false\r\n      } else {\r\n        //获取后缀\r\n        let suff = name.substring(name.lastIndexOf('.') + 1)\r\n        var count = 0\r\n        //遍历提前定义好的后缀数组\r\n        for (var i in this.fileNameMatch) {\r\n          //如果有匹配的(注意大小写问题)\r\n          if (this.fileNameMatch[i].toLowerCase() == suff.toLowerCase()) {\r\n            count++\r\n            //匹配到就退出循环\r\n            break\r\n          }\r\n        }\r\n        //如果没匹配到\r\n        if (count == 0) {\r\n          this.$message.warning('只能上传jpg,png,jpeg格式的图片')\r\n          return false\r\n        }\r\n      }\r\n\r\n      //判断文件大小\r\n      if (file.size > 1024 * 1024 * 10) {\r\n        this.$message.warning('文件大小不能超过10MB')\r\n        return false\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.submit-note-content {\r\n  flex: 1;\r\n  background: #fff;\r\n  border-radius: 5px;\r\n  border: 1px solid #dcdcdc;\r\n  border-bottom: none;\r\n  padding: 10px;\r\n\r\n  .require {\r\n    &::before {\r\n      content: '*';\r\n      color: #f56c6c;\r\n      margin-right: 4px;\r\n    }\r\n  }\r\n\r\n  .title {\r\n    & > span {\r\n      margin-right: 20px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n\r\n  .tag {\r\n    & > span {\r\n      margin-right: 24px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n\r\n  .content {\r\n    .content-title {\r\n      margin-bottom: 10px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n  .upload {\r\n    & > span {\r\n      margin-right: 24px;\r\n      margin-top: 5px;\r\n    }\r\n    display: flex;\r\n    align-items: flex-start;\r\n    margin-top: 5px;\r\n    height: 80px;\r\n    margin-bottom: 5px;\r\n  }\r\n\r\n  .submit {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n}\r\n</style>\r\n"]}]}