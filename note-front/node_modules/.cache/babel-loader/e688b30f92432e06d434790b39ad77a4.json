{"remainingRequest":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\babel-loader@8.3.0\\node_modules\\babel-loader\\lib\\index.js!D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue","mtime":1703320567699},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\babel.config.js","mtime":1703320567604},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\babel-loader@8.3.0\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\2718075060\\Desk\\sspku\\云计算\\Note\\note-front\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBFZGl0b3IgZnJvbSAnLi9FZGl0b3IudnVlJzsKaW1wb3J0IHsgc2F2ZU5vdGVEYXRhIH0gZnJvbSAnQC9uZXR3b3JrL25vdGUvaW5kZXguanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRpdGxlOiAnJywKICAgICAgdGFnVmFsdWVzOiBbXSwKICAgICAgbm90ZUNvbnRlbnQ6ICcnLAogICAgICB0YWdPcHRpb25zOiBbJ0hUTUwnLCAnTXlTUUwnLCAnUEhQJywgJ0phdmEnLCAnUHl0aG9uJ10sCiAgICAgIHVwbG9hZFVybDogJycsCiAgICAgIGZpbGVMaXN0OiBbXSwKICAgICAgZmlsZU5hbWVNYXRjaDogWydqcGVnJywgJ2pwZycsICdwbmcnXQogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEVkaXRvcgogIH0sCiAgbWV0aG9kczogewogICAgLyoqDQogICAgICog5a6e6ZmF5o+Q5Lqk5pWw5o2u5pa55rOVDQogICAgICovCiAgICBhc3luYyBzdWJtaXROb3RlRGF0YShwYXJhbSkgewogICAgICB2YXIgX3RoaXMkJHJvdXRlOwogICAgICBpZiAodGhpcy4kcmVmcy5lZGl0b3IuaXNOZWVkVXBsb2FkKCkpIHsKICAgICAgICAvLyDlpoLmnpznrJTorrDlhoXmnInlm77niYfvvIzpgqPkuYjlhYjov5vooYzlm77niYfkuIrkvKAKICAgICAgICBhd2FpdCB0aGlzLiRyZWZzLmVkaXRvci51cGxvYWRpbWcoKTsKICAgICAgfQoKICAgICAgLy8g5a+55aSa5LiqdGFn6L+b6KGM6L2s5o2i5pWw5o2u5qC85byPCiAgICAgIGNvbnN0IHRhZ3MgPSB0aGlzLnRhZ1ZhbHVlcy5qb2luKCcsJyk7CiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CgogICAgICAvLyDlpoLmnpzlnLDlnYDmoI/kuIrmnIlncm91cElk77yM6K+B5piO5piv5YiG57uE5YaF5o+Q5Lqk55qECiAgICAgIGNvbnN0IGlkID0gKF90aGlzJCRyb3V0ZSA9IHRoaXMuJHJvdXRlKSA9PT0gbnVsbCB8fCBfdGhpcyQkcm91dGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJCRyb3V0ZS5xdWVyeS5ncm91cElkOwogICAgICBpZiAoaWQpIGZvcm1EYXRhLmFwcGVuZCgnZ3JvdXBJZCcsIGlkKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCdub3RlSW1nJywgcGFyYW0uZmlsZSk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGl0bGUnLCB0aGlzLnRpdGxlKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCdjb250ZW50JywgdGhpcy5ub3RlQ29udGVudCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGFnJywgdGFncyk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcklkJywgdGhpcy4kc3RvcmUuc3RhdGUudXNlckluZm8udXNlcmlkKTsKICAgICAgc2F2ZU5vdGVEYXRhKGZvcm1EYXRhKS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+eslOiusOWPkeW4g+aIkOWKnycpOwogICAgICAgIGlkID8gdGhpcy4kcm91dGVyLnB1c2goYC9ncm91cD9pZD0ke2lkfSZwYWdlPTFgKSA6IHRoaXMuJHJvdXRlci5wdXNoKCcvJyk7CiAgICAgIH0pOwogICAgfSwKICAgIHZhbGlkYXRlTm90ZUluZm8oKSB7CiAgICAgIGlmICh0aGlzLnRpdGxlID09ICcnIHx8IHRoaXMudGFnVmFsdWVzLmxlbmd0aCA9PT0gMCB8fCB0aGlzLm5vdGVDb250ZW50ID09ICcnIHx8IHRoaXMuJHJlZnMudXBsb2FkLnVwbG9hZEZpbGVzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfkv6Hmga/mnKrloavlrozmlbTvvIzor7fmo4Dmn6UnKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgaGFuZGxlU3VibWl0Tm90ZSgpIHsKICAgICAgaWYgKHRoaXMudmFsaWRhdGVOb3RlSW5mbygpKSB7CiAgICAgICAgLy8g6LCD55SodXBsb2Fk57uE5Lu255qE5LiK5Lyg5pa55rOV77yM5Zyo5a6D5YaF6YOo5YGa5o+Q5LqkCiAgICAgICAgdGhpcy4kcmVmcy51cGxvYWQuc3VibWl0KCk7CiAgICAgIH0KICAgIH0sCiAgICBjaGVja0ZpbGUoZmlsZSkgewogICAgICAvL+S4iuS8oOS5i+WJjeeahOaTjeS9nO+8jGZpbGXkuIrkvKDnmoTmlofku7blr7nosaEKICAgICAgbGV0IG5hbWUgPSBmaWxlLm5hbWU7CiAgICAgIGlmIChuYW1lLmxhc3RJbmRleE9mKCcuJykgPT0gLTEpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+aWh+S7tuagvOW8j+S4jeato+ehricpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvL+iOt+WPluWQjue8gAogICAgICAgIGxldCBzdWZmID0gbmFtZS5zdWJzdHJpbmcobmFtZS5sYXN0SW5kZXhPZignLicpICsgMSk7CiAgICAgICAgdmFyIGNvdW50ID0gMDsKICAgICAgICAvL+mBjeWOhuaPkOWJjeWumuS5ieWlveeahOWQjue8gOaVsOe7hAogICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5maWxlTmFtZU1hdGNoKSB7CiAgICAgICAgICAvL+WmguaenOacieWMuemFjeeahCjms6jmhI/lpKflsI/lhpnpl67popgpCiAgICAgICAgICBpZiAodGhpcy5maWxlTmFtZU1hdGNoW2ldLnRvTG93ZXJDYXNlKCkgPT0gc3VmZi50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgICAgIC8v5Yy56YWN5Yiw5bCx6YCA5Ye65b6q546vCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvL+WmguaenOayoeWMuemFjeWIsAogICAgICAgIGlmIChjb3VudCA9PSAwKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+WPquiDveS4iuS8oGpwZyxwbmcsanBlZ+agvOW8j+eahOWbvueJhycpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLy/liKTmlq3mlofku7blpKflsI8KICAgICAgaWYgKGZpbGUuc2l6ZSA+IDEwMjQgKiAxMDI0ICogMTApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+aWh+S7tuWkp+Wwj+S4jeiDvei2hei/hzEwTUInKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"names":["Editor","saveNoteData","data","title","tagValues","noteContent","tagOptions","uploadUrl","fileList","fileNameMatch","components","methods","submitNoteData","param","_this$$route","$refs","editor","isNeedUpload","uploadimg","tags","join","formData","FormData","id","$route","query","groupId","append","file","$store","state","userInfo","userid","then","$message","success","$router","push","validateNoteInfo","length","upload","uploadFiles","warning","handleSubmitNote","submit","checkFile","name","lastIndexOf","suff","substring","count","i","toLowerCase","size"],"sources":["src/views/submitNote/childrens/SubmitNoteContent.vue"],"sourcesContent":["<template>\r\n  <div class=\"submit-note-content\">\r\n    <div class=\"title\">\r\n      <span class=\"require\">Note Title </span>\r\n      <el-input\r\n        style=\"width: 350px\"\r\n        type=\"text\"\r\n        placeholder=\"please input note title\"\r\n        v-model=\"title\"\r\n        maxlength=\"20\"\r\n        show-word-limit\r\n      >\r\n      </el-input>\r\n    </div>\r\n\r\n    <div class=\"tag\">\r\n      <span class=\"require\">Note Tag </span>\r\n\r\n      <el-select\r\n        v-model=\"tagValues\"\r\n        multiple\r\n        placeholder=\"please select tag\"\r\n        style=\"width: 350px\"\r\n      >\r\n        <el-option v-for=\"item in tagOptions\" :key=\"item\" :value=\"item\">\r\n        </el-option>\r\n      </el-select>\r\n    </div>\r\n    <div class=\"content\">\r\n      <div class=\"content-title require\">Note Content</div>\r\n      <Editor v-model=\"noteContent\" ref=\"editor\" />\r\n    </div>\r\n\r\n    <div class=\"upload\">\r\n      <span class=\"require\">Note Image</span>\r\n      <el-upload\r\n        ref=\"upload\"\r\n        :action=\"uploadUrl\"\r\n        :file-list=\"fileList\"\r\n        :auto-upload=\"false\"\r\n        :before-upload=\"checkFile\"\r\n        accept=\".jpg,.png,.jpeg\"\r\n        :http-request=\"submitNoteData\"\r\n        :limit=\"1\"\r\n      >\r\n        <el-button size=\"small\" type=\"primary\">post note image</el-button>\r\n        <div slot=\"tip\" class=\"el-upload__tip\">\r\n          Only a single image in jpg/png/jpeg format can be uploaded and the\r\n          maximum size is 10MB\r\n        </div>\r\n      </el-upload>\r\n    </div>\r\n\r\n    <div class=\"submit\">\r\n      <el-button type=\"primary\" @click=\"handleSubmitNote\"\r\n        >submit note</el-button\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Editor from './Editor.vue'\r\nimport { saveNoteData } from '@/network/note/index.js'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      title: '',\r\n      tagValues: [],\r\n      noteContent: '',\r\n      tagOptions: ['HTML', 'MySQL', 'PHP', 'Java', 'Python'],\r\n      uploadUrl: '',\r\n      fileList: [],\r\n      fileNameMatch: ['jpeg', 'jpg', 'png']\r\n    }\r\n  },\r\n  components: { Editor },\r\n  methods: {\r\n    /**\r\n     * 实际提交数据方法\r\n     */\r\n    async submitNoteData(param) {\r\n      if (this.$refs.editor.isNeedUpload()) {\r\n        // 如果笔记内有图片，那么先进行图片上传\r\n        await this.$refs.editor.uploadimg()\r\n      }\r\n\r\n      // 对多个tag进行转换数据格式\r\n      const tags = this.tagValues.join(',')\r\n\r\n      const formData = new FormData()\r\n\r\n      // 如果地址栏上有groupId，证明是分组内提交的\r\n      const id = this.$route?.query.groupId\r\n      if (id) formData.append('groupId', id)\r\n\r\n      formData.append('noteImg', param.file)\r\n      formData.append('title', this.title)\r\n      formData.append('content', this.noteContent)\r\n      formData.append('tag', tags)\r\n      formData.append('userId', this.$store.state.userInfo.userid)\r\n\r\n      saveNoteData(formData).then(() => {\r\n        this.$message.success('笔记发布成功')\r\n        id\r\n          ? this.$router.push(`/group?id=${id}&page=1`)\r\n          : this.$router.push('/')\r\n      })\r\n    },\r\n    validateNoteInfo() {\r\n      if (\r\n        this.title == '' ||\r\n        this.tagValues.length === 0 ||\r\n        this.noteContent == '' ||\r\n        this.$refs.upload.uploadFiles.length == 0\r\n      ) {\r\n        this.$message.warning('信息未填完整，请检查')\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    handleSubmitNote() {\r\n      if (this.validateNoteInfo()) {\r\n        // 调用upload组件的上传方法，在它内部做提交\r\n        this.$refs.upload.submit()\r\n      }\r\n    },\r\n    checkFile(file) {\r\n      //上传之前的操作，file上传的文件对象\r\n      let name = file.name\r\n      if (name.lastIndexOf('.') == -1) {\r\n        this.$message.warning('文件格式不正确')\r\n        return false\r\n      } else {\r\n        //获取后缀\r\n        let suff = name.substring(name.lastIndexOf('.') + 1)\r\n        var count = 0\r\n        //遍历提前定义好的后缀数组\r\n        for (var i in this.fileNameMatch) {\r\n          //如果有匹配的(注意大小写问题)\r\n          if (this.fileNameMatch[i].toLowerCase() == suff.toLowerCase()) {\r\n            count++\r\n            //匹配到就退出循环\r\n            break\r\n          }\r\n        }\r\n        //如果没匹配到\r\n        if (count == 0) {\r\n          this.$message.warning('只能上传jpg,png,jpeg格式的图片')\r\n          return false\r\n        }\r\n      }\r\n\r\n      //判断文件大小\r\n      if (file.size > 1024 * 1024 * 10) {\r\n        this.$message.warning('文件大小不能超过10MB')\r\n        return false\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.submit-note-content {\r\n  flex: 1;\r\n  background: #fff;\r\n  border-radius: 5px;\r\n  border: 1px solid #dcdcdc;\r\n  border-bottom: none;\r\n  padding: 10px;\r\n\r\n  .require {\r\n    &::before {\r\n      content: '*';\r\n      color: #f56c6c;\r\n      margin-right: 4px;\r\n    }\r\n  }\r\n\r\n  .title {\r\n    & > span {\r\n      margin-right: 20px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n\r\n  .tag {\r\n    & > span {\r\n      margin-right: 24px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n\r\n  .content {\r\n    .content-title {\r\n      margin-bottom: 10px;\r\n    }\r\n    margin-bottom: 15px;\r\n  }\r\n  .upload {\r\n    & > span {\r\n      margin-right: 24px;\r\n      margin-top: 5px;\r\n    }\r\n    display: flex;\r\n    align-items: flex-start;\r\n    margin-top: 5px;\r\n    height: 80px;\r\n    margin-bottom: 5px;\r\n  }\r\n\r\n  .submit {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";AA8DA,OAAAA,MAAA;AACA,SAAAC,YAAA;AAEA;EACAC,KAAA;IACA;MACAC,KAAA;MACAC,SAAA;MACAC,WAAA;MACAC,UAAA;MACAC,SAAA;MACAC,QAAA;MACAC,aAAA;IACA;EACA;EACAC,UAAA;IAAAV;EAAA;EACAW,OAAA;IACA;AACA;AACA;IACA,MAAAC,eAAAC,KAAA;MAAA,IAAAC,YAAA;MACA,SAAAC,KAAA,CAAAC,MAAA,CAAAC,YAAA;QACA;QACA,WAAAF,KAAA,CAAAC,MAAA,CAAAE,SAAA;MACA;;MAEA;MACA,MAAAC,IAAA,QAAAf,SAAA,CAAAgB,IAAA;MAEA,MAAAC,QAAA,OAAAC,QAAA;;MAEA;MACA,MAAAC,EAAA,IAAAT,YAAA,QAAAU,MAAA,cAAAV,YAAA,uBAAAA,YAAA,CAAAW,KAAA,CAAAC,OAAA;MACA,IAAAH,EAAA,EAAAF,QAAA,CAAAM,MAAA,YAAAJ,EAAA;MAEAF,QAAA,CAAAM,MAAA,YAAAd,KAAA,CAAAe,IAAA;MACAP,QAAA,CAAAM,MAAA,eAAAxB,KAAA;MACAkB,QAAA,CAAAM,MAAA,iBAAAtB,WAAA;MACAgB,QAAA,CAAAM,MAAA,QAAAR,IAAA;MACAE,QAAA,CAAAM,MAAA,gBAAAE,MAAA,CAAAC,KAAA,CAAAC,QAAA,CAAAC,MAAA;MAEA/B,YAAA,CAAAoB,QAAA,EAAAY,IAAA;QACA,KAAAC,QAAA,CAAAC,OAAA;QACAZ,EAAA,GACA,KAAAa,OAAA,CAAAC,IAAA,cAAAd,EAAA,aACA,KAAAa,OAAA,CAAAC,IAAA;MACA;IACA;IACAC,iBAAA;MACA,IACA,KAAAnC,KAAA,UACA,KAAAC,SAAA,CAAAmC,MAAA,UACA,KAAAlC,WAAA,UACA,KAAAU,KAAA,CAAAyB,MAAA,CAAAC,WAAA,CAAAF,MAAA,OACA;QACA,KAAAL,QAAA,CAAAQ,OAAA;QACA;MACA;MACA;IACA;IACAC,iBAAA;MACA,SAAAL,gBAAA;QACA;QACA,KAAAvB,KAAA,CAAAyB,MAAA,CAAAI,MAAA;MACA;IACA;IACAC,UAAAjB,IAAA;MACA;MACA,IAAAkB,IAAA,GAAAlB,IAAA,CAAAkB,IAAA;MACA,IAAAA,IAAA,CAAAC,WAAA;QACA,KAAAb,QAAA,CAAAQ,OAAA;QACA;MACA;QACA;QACA,IAAAM,IAAA,GAAAF,IAAA,CAAAG,SAAA,CAAAH,IAAA,CAAAC,WAAA;QACA,IAAAG,KAAA;QACA;QACA,SAAAC,CAAA,SAAA1C,aAAA;UACA;UACA,SAAAA,aAAA,CAAA0C,CAAA,EAAAC,WAAA,MAAAJ,IAAA,CAAAI,WAAA;YACAF,KAAA;YACA;YACA;UACA;QACA;QACA;QACA,IAAAA,KAAA;UACA,KAAAhB,QAAA,CAAAQ,OAAA;UACA;QACA;MACA;;MAEA;MACA,IAAAd,IAAA,CAAAyB,IAAA;QACA,KAAAnB,QAAA,CAAAQ,OAAA;QACA;MACA;IACA;EACA;AACA"}]}